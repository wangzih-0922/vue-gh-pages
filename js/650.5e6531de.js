"use strict";(self["webpackChunkvue_w6_cli"]=self["webpackChunkvue_w6_cli"]||[]).push([[650],{1650:function(e,t,a){a.r(t),a.d(t,{default:function(){return E}});var l=a(6252),s=a(3577),i=a(9963);const o=(0,l._)("h2",{class:"text-center mt-3"},"購物車列表",-1),d={class:"container"},n={class:"mt-4"},r={class:"text-end"},c=["disabled"],u={class:"table align-middle"},m=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("th"),(0,l._)("th",null,"品名"),(0,l._)("th",{style:{width:"150px"}},"數量/單位"),(0,l._)("th",null,"單價")])],-1),h=["onClick"],p={class:"input-group input-group-sm"},g={class:"input-group mb-3"},_=["onUpdate:modelValue","onChange","disabled"],b=["value"],v={class:"input-group-text",id:"basic-addon2"},f={class:"text-end"},y=(0,l._)("td",{colspan:"3",class:"text-end"},"總計",-1),C={class:"text-end"},w={class:"my-5 row justify-content-center"},x={class:"mb-3"},k=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),L={class:"mb-3"},V=(0,l._)("label",{for:"name",class:"form-label"},"收件人姓名",-1),D={class:"mb-3"},W=(0,l._)("label",{for:"tel",class:"form-label"},"收件人電話",-1),$={class:"mb-3"},q=(0,l._)("label",{for:"address",class:"form-label"},"收件人地址",-1),U={class:"mb-3"},I=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),z={class:"text-end"},A=["disabled"];function F(e,t,a,F,H,M){const Y=(0,l.up)("LoadingOverlay"),E=(0,l.up)("MyField"),K=(0,l.up)("error-message"),S=(0,l.up)("MyForm");return(0,l.wg)(),(0,l.iD)(l.HY,null,[o,(0,l._)("div",d,[(0,l.Wm)(Y,{active:H.isLoading},null,8,["active"]),(0,l._)("div",n,[(0,l._)("div",r,[(0,l._)("button",{class:"btn btn-outline-danger",type:"button",onClick:t[0]||(t[0]=(...e)=>M.delAllCart&&M.delAllCart(...e)),disabled:0===H.cartData.carts.length},"清空購物車",8,c)]),(0,l._)("table",u,[m,(0,l._)("tbody",null,[H.cartData.carts?((0,l.wg)(!0),(0,l.iD)(l.HY,{key:0},(0,l.Ko)(H.cartData.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>M.delCartItem(e.id)},"x",8,h)]),(0,l._)("td",null,(0,s.zw)(e.product.title),1),(0,l._)("td",null,[(0,l._)("div",p,[(0,l._)("div",g,[(0,l.wy)((0,l._)("select",{class:"form-select","onUpdate:modelValue":t=>e.qty=t,onChange:t=>M.updatedproduct(e),disabled:H.isLoadingItem===e.id},[((0,l.wg)(),(0,l.iD)(l.HY,null,(0,l.Ko)(20,(t=>(0,l._)("option",{value:t,key:`${t}-${e.id}`},(0,s.zw)(t),9,b))),64))],40,_),[[i.bM,e.qty]]),(0,l._)("span",v,(0,s.zw)(e.product.unit),1)])])]),(0,l._)("td",f,(0,s.zw)(e.total),1)])))),128)):(0,l.kq)("",!0)]),(0,l._)("tfoot",null,[(0,l._)("tr",null,[y,(0,l._)("td",C,(0,s.zw)(H.cartData.total),1)])])])]),(0,l._)("div",w,[(0,l.Wm)(S,{ref:"form",class:"col-md-6",onSubmit:M.submit},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",x,[k,(0,l.Wm)(E,{id:"email",name:"email",type:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:H.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>H.user.email=e)},null,8,["class","modelValue"]),(0,l.Wm)(K,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",L,[V,(0,l.Wm)(E,{id:"name",name:"姓名",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:H.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>H.user.name=e)},null,8,["class","modelValue"]),(0,l.Wm)(K,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",D,[W,(0,l.Wm)(E,{id:"tel",name:"電話",type:"tel",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),placeholder:"請輸入電話",rules:"min:8|max:10|required",modelValue:H.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>H.user.tel=e)},null,8,["class","modelValue"]),(0,l.Wm)(K,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",$,[q,(0,l.Wm)(E,{id:"address",name:"地址",type:"text",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:H.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>H.user.address=e)},null,8,["class","modelValue"]),(0,l.Wm)(K,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",U,[I,(0,l.wy)((0,l._)("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":t[5]||(t[5]=e=>H.message=e)},null,512),[[i.nr,H.message]])]),(0,l._)("div",z,[(0,l._)("button",{type:"submit",class:"btn btn-danger",disabled:0===H.cartData.carts.length},"送出訂單",8,A)])])),_:1},8,["onSubmit"])])])],64)}var H={data(){return{productData:[],id:"",cartData:{carts:[]},isLoadingItem:"",isLoading:!1,user:{name:"",email:"",tel:"",address:""},message:""}},methods:{getCartList(){this.isLoading=!0,this.$http.get("https://vue3-course-api.hexschool.io/v2/api/chingno2004/cart").then((e=>{this.cartData=e.data.data,this.isLoading=!1})).catch((e=>{console.log(e)}))},delAllCart(){this.$http.delete("https://vue3-course-api.hexschool.io/v2/api/chingno2004/carts").then((e=>{alert("已刪除全部購物車"),this.getCartList()})).catch((e=>{console.log(e)}))},delCartItem(e){this.$http.delete(`https://vue3-course-api.hexschool.io/v2/api/chingno2004/cart/${e}`).then((e=>{alert("已刪除此商品"),this.getCartList()})).catch((e=>{console.log(e)}))},updatedproduct(e){this.isLoadingItem=e.id,this.$http.put(`https://vue3-course-api.hexschool.io/v2/api/chingno2004/cart/${e.id}`,{data:{product_id:e.id,qty:e.qty}}).then((e=>{alert("購物車已更新"),this.getCartList(),this.isLoadingItem=""})).catch((e=>{console.log(e)}))},submit(){this.$http.post("https://vue3-course-api.hexschool.io/v2/api/chingno2004/order",{data:{user:this.user,message:this.message}}).then((e=>{alert(e.data.message),this.getCartList(),this.$refs.form.resetForm(),this.message=""})).catch((e=>{console.log(e),alert(e.data.message)}))}},mounted(){this.getCartList()}},M=a(3744);const Y=(0,M.Z)(H,[["render",F]]);var E=Y}}]);
//# sourceMappingURL=650.5e6531de.js.map